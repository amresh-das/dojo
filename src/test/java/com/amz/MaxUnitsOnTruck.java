package com.amz;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

import java.util.Collections;
import java.util.SortedMap;
import java.util.TreeMap;

/**
 * @see "https://leetcode.com/problems/maximum-units-on-a-truck/"
 */
public class MaxUnitsOnTruck {

    public int maximumUnits(int[][] boxTypes, int truckSize) {
        SortedMap<Integer, Integer> boxes = new TreeMap<>(Collections.reverseOrder());
        for (int[] boxType: boxTypes) {
            boxes.compute(boxType[1], (k, v) -> v == null ? boxType[0] : v + boxType[0]);
        }
        int sum = 0, remainingSize = truckSize;
        while (remainingSize > 0 && !boxes.isEmpty()) {
            int unitsPerBox = boxes.firstKey();
            int usable = Math.min(remainingSize, boxes.get(unitsPerBox));
            remainingSize -= usable;
            sum += unitsPerBox * usable;
            boxes.remove(unitsPerBox);
        }
        return sum;
    }

    @Test
    public void check1() {
        Assertions.assertEquals(8, maximumUnits(Utils.to2dIntMatrix("[[1,3],[2,2],[3,1]]"), 4));
    }

    @Test
    public void check2() {
        Assertions.assertEquals(91, maximumUnits(Utils.to2dIntMatrix("[[5,10],[2,5],[4,7],[3,9]]"), 10));
    }

    @Test
    public void check3() {
        Assertions.assertEquals(48, maximumUnits(Utils.to2dIntMatrix("[[2,1],[4,4],[3,1],[4,1],[2,4],[3,4],[1,3],[4,3],[5,3],[5,3]]"), 13));
    }

    @Test
    public void check4() {
        Assertions.assertEquals(245226889, maximumUnits(Utils.to2dIntMatrix("[[386,707],[63,739],[309,242],[163,741],[880,634],[248,789],[298,526],[663,846],[325,105],[29,799],[116,6],[624,823],[165,475],[508,846],[177,745],[964,697],[449,83],[46,5],[949,455],[47,93],[245,323],[406,1],[589,583],[643,815],[38,669],[679,72],[919,676],[453,455],[816,418],[356,159],[274,792],[135,763],[43,863],[340,667],[488,552],[333,233],[415,659],[666,173],[131,492],[548,745],[540,353],[418,426],[90,408],[353,950],[517,978],[179,595],[624,214],[887,767],[82,674],[584,372],[693,312],[611,346],[268,267],[281,619],[170,711],[180,388],[855,914],[596,93],[704,344],[740,948],[248,257],[149,438],[339,355],[17,725],[28,970],[808,21],[156,636],[518,178],[230,644],[343,206],[549,183],[393,124],[770,473],[368,660],[362,678],[8,191],[6,276],[839,527],[630,389],[660,79],[893,314],[863,561],[81,902],[312,434],[596,125],[65,972],[845,754],[219,514],[810,489],[850,475],[161,855],[659,805],[206,522],[626,792],[589,37],[490,949],[590,1],[189,140],[522,365],[970,185],[69,632],[786,842],[625,460],[457,24],[598,970],[557,656],[105,245],[383,844],[539,742],[669,32],[527,958],[882,158],[252,67],[98,311],[627,4],[748,301],[701,379],[492,370],[636,223],[339,690],[98,763],[51,878],[68,788],[204,343],[344,621],[785,126],[367,172],[809,124],[737,883],[541,676],[738,374],[851,738],[894,164],[175,984],[31,679],[960,747],[459,384],[709,722],[351,55],[775,224],[173,222],[468,150],[638,277],[244,201],[262,82],[448,260],[253,49],[572,870],[775,619],[490,686],[952,640],[404,579],[447,376],[95,919],[70,128],[54,561],[908,700],[773,479],[682,800],[300,355],[218,532],[85,879],[243,133],[928,962],[449,957],[389,799],[758,981],[738,950],[660,848],[556,745],[319,681],[605,483],[27,501],[775,888],[731,711],[647,936],[432,9],[122,503],[913,166],[431,211],[473,856],[776,157],[688,872],[278,984],[887,68],[113,836],[345,308],[63,109],[856,414],[55,470],[746,28],[62,404],[956,166],[94,462],[153,147],[768,293],[989,815],[523,447],[186,415],[608,380],[600,377],[279,162],[983,522],[672,615],[285,554],[310,270],[136,535],[548,353],[473,416],[818,554],[617,488],[974,368],[838,104],[68,279],[140,830],[835,374],[856,177],[1,632],[990,237],[607,912],[384,471],[387,525],[919,390],[67,5],[593,715],[246,653],[989,659],[427,900],[276,161],[362,998],[79,507],[355,375],[942,259],[666,928],[242,315],[575,129],[155,461],[824,325],[626,618],[968,272],[734,727],[99,169],[33,831],[594,872],[107,175],[349,926],[883,788],[913,515],[757,619],[494,122],[608,443],[799,933],[627,317],[832,55],[768,444],[918,854],[185,188],[591,829],[650,840],[611,367],[422,22],[230,588],[895,774],[289,687],[810,112],[17,26],[939,453],[765,820],[559,737],[947,448],[452,367],[892,819],[864,665],[176,422],[281,352],[968,941],[757,532],[602,86],[698,457],[436,385],[167,197],[990,259],[125,822],[123,909],[452,51],[336,814],[679,628],[152,449],[50,828],[350,879],[654,17],[73,371],[986,323],[168,286],[474,356],[528,304],[415,424],[540,231],[551,318],[959,998],[245,759],[553,818],[259,282],[959,264],[56,656],[941,165],[899,901],[792,923],[278,935],[951,715],[753,554],[863,305],[639,211],[44,613],[25,717],[805,855],[30,325],[255,29],[588,896],[892,379],[945,909],[508,55],[619,152],[375,17],[62,605],[548,856],[234,289],[304,347],[499,334],[356,304],[867,465],[547,448],[954,83],[784,380],[641,47],[142,294],[316,268],[848,524],[905,135],[602,816],[181,514],[681,183],[429,208],[952,9],[534,728],[495,993],[732,782],[199,660],[527,236],[384,791],[262,500],[244,142],[431,944],[831,167],[565,243],[728,452],[332,977],[209,898],[971,284],[439,998],[960,547],[584,220],[499,314],[395,196],[71,89],[532,686],[627,608],[208,128],[212,394],[447,619],[306,628],[871,244],[834,166],[479,25],[62,530],[547,758],[913,256],[224,37],[876,526],[152,833],[170,517],[309,533],[448,76],[172,129],[730,780],[727,267],[206,348],[476,802],[723,38],[796,558],[225,735],[845,138],[132,775],[887,308],[731,882],[225,170],[460,201],[713,550],[643,144],[286,491],[934,662],[727,444],[48,271],[12,427],[884,178],[870,814],[163,666],[173,745],[263,259],[246,843],[990,868],[965,160],[851,166],[624,648],[233,633],[582,425],[887,318],[818,589],[560,581],[108,939],[520,892],[944,170],[919,877],[915,64],[10,465],[168,946],[798,610],[867,436],[268,340],[362,816],[977,903],[263,124],[521,639],[494,954],[330,191],[527,628],[597,82],[425,624],[479,933],[442,263],[647,68],[735,199],[31,881],[345,11],[73,929],[891,878],[847,751],[216,305],[637,319],[51,265],[483,683],[283,839],[711,283],[500,275],[751,360],[490,675],[507,258],[893,290],[245,617],[711,438],[723,505],[524,51],[419,634],[490,916],[677,643],[564,355],[420,194],[621,87],[20,117],[141,1],[394,363],[189,460],[613,243],[493,844],[345,500],[21,104],[912,503],[321,29],[938,289],[172,143],[515,17],[367,448],[260,709],[737,83],[725,893],[123,274],[258,652],[890,297],[652,666],[864,512],[928,855],[712,999],[495,72],[705,542],[963,893],[840,626],[653,335],[313,595],[458,214],[702,879],[807,54],[892,274],[184,270],[5,816],[841,231],[137,998],[326,451],[619,851],[339,184],[105,718],[425,194],[362,907],[868,513],[130,972],[671,955],[443,439],[497,194],[303,721],[840,211],[382,655],[432,700],[624,512],[93,68],[240,427],[518,44],[339,323],[229,387],[108,232],[180,17],[502,599],[805,497],[6,143],[934,710],[295,662],[171,807],[827,609],[762,793],[638,702],[811,52],[479,125],[336,765],[322,342],[780,527],[283,852],[888,530],[459,703],[463,48],[712,329],[58,441],[94,364],[204,628],[325,69],[5,832],[757,397],[738,322],[335,476],[942,656],[281,490],[89,105],[607,686],[775,157],[96,332],[554,551],[364,937],[950,731],[354,107],[710,714],[659,6],[205,853],[188,714],[276,670],[45,4],[433,369],[334,593],[23,478],[785,166],[776,708],[972,971],[744,861],[712,796],[946,353],[604,630],[194,785],[889,552],[565,809],[898,797],[180,741],[216,167],[323,153],[117,298],[339,848],[264,47],[911,949],[657,868],[577,37],[831,930],[412,37],[673,568],[238,479],[973,875],[835,958],[565,928],[970,324],[378,663],[130,44],[275,504],[963,705],[115,226],[690,574],[577,472],[412,191],[822,292],[501,720],[160,294],[262,809],[321,997],[238,919],[663,31],[776,695],[692,583],[354,19],[197,892],[108,803],[172,635],[601,184],[933,73],[134,852],[548,13],[63,165],[357,779],[673,521],[435,715],[336,903],[658,701],[75,130],[447,46],[327,822],[157,896],[253,598],[57,836],[611,392],[196,471],[50,608],[334,926],[127,475],[147,820],[173,70],[239,199],[28,423],[785,567],[651,470],[722,23],[874,318],[136,336],[626,82],[141,126],[787,893],[110,542],[644,564],[112,655],[815,941],[194,138],[282,117],[672,849],[182,206],[588,721],[47,79],[976,376],[885,287],[302,995],[203,887],[908,123],[356,754],[627,952],[596,515],[582,996],[62,526],[450,307],[625,557],[616,935],[11,759],[394,117],[978,903],[162,830],[149,244],[479,562],[339,954],[115,256],[104,259],[937,13],[304,399],[661,980],[447,828],[496,325],[546,919],[511,841],[123,430],[555,475],[187,805],[337,212],[684,411],[574,327],[21,123],[137,144],[516,474],[386,265],[250,743],[787,783],[544,652],[523,448],[738,477],[950,328],[1,799],[952,852],[257,14],[726,960],[689,521],[53,776],[286,453],[872,652],[850,245],[588,337],[508,134],[887,817],[454,572],[792,47],[2,194],[564,609],[159,17],[175,674],[754,511],[948,860],[971,434],[972,358],[527,492],[777,678],[394,170],[140,756],[217,749],[188,273],[958,853],[48,22],[148,654],[506,698],[704,977],[500,441],[54,147],[726,622],[576,769],[475,573],[891,503],[805,221],[888,574],[153,189],[643,836],[910,298],[770,518],[450,785],[444,264],[785,798],[948,239],[320,273],[567,972],[500,825],[534,159],[610,103],[137,515],[707,114],[318,276],[516,229],[676,451],[486,665],[719,473],[561,336],[734,58],[884,841],[605,328],[289,332],[571,456],[196,736],[610,384],[222,643],[57,815],[258,455],[885,389],[671,734],[481,790],[82,349],[509,859],[691,393],[911,472],[762,711],[996,513],[255,650],[386,159],[773,163],[972,533],[244,243],[489,688],[45,927],[409,293],[373,562],[909,573],[739,662],[525,639],[348,259],[81,821],[392,779],[851,940],[394,450],[196,136],[693,676],[669,365],[914,35],[672,654],[633,923],[901,315],[127,242],[581,659],[298,813],[158,335],[936,147],[573,725],[995,570],[701,957],[754,739],[373,572],[529,29],[625,75],[209,461],[264,746],[246,835],[85,337],[626,58],[271,909],[641,867],[710,184],[335,346],[21,684],[130,747],[66,583],[496,780],[442,396],[54,289],[223,276],[999,598],[749,783],[29,525],[590,224],[932,989],[692,304],[194,275],[567,692],[353,713],[802,515],[797,976],[120,377],[510,400],[672,909],[902,975],[540,382],[138,405],[613,170],[416,45],[369,352],[620,273],[217,903],[869,167],[397,14],[499,215],[604,144],[634,302],[989,348],[210,663],[555,839],[825,496],[651,509],[123,842],[168,131],[125,802],[330,369],[442,250],[508,915],[364,494],[628,917],[809,800],[960,637],[290,779],[301,42],[172,468],[587,893],[876,159],[523,189],[761,329],[602,887],[994,343],[206,514],[464,399],[760,891],[533,72],[21,794],[497,962],[588,1000],[285,605],[845,724],[674,972],[876,593],[723,438],[325,427],[586,328],[506,238],[256,923],[465,238],[257,727],[492,795],[804,555],[243,881],[355,231],[71,455],[135,293],[211,417],[456,273],[760,251],[829,478],[796,36],[563,786],[771,844],[573,566],[717,211],[246,176],[367,477],[108,658],[583,316],[738,558],[670,412],[972,175],[918,44],[732,329],[692,34],[513,655],[314,412],[947,401],[655,937],[776,670],[387,583],[635,71],[73,652],[641,344],[287,141],[436,149],[113,596],[952,299],[940,430],[344,286],[17,335],[983,911],[837,751],[683,691],[92,53],[632,400],[604,677],[568,440],[120,81],[880,89],[124,866],[381,429],[944,456],[928,147],[596,1],[188,495],[626,945],[243,105],[30,380],[562,923],[942,400],[198,368],[394,991],[255,274],[790,255],[485,990],[79,6],[245,165],[510,765],[329,109],[305,522],[364,357],[436,158],[929,473],[983,549],[669,8],[200,835],[199,11],[874,263],[102,334],[433,896],[285,228],[432,318],[738,531],[966,136],[526,597]]"), 781556));
    }

}
